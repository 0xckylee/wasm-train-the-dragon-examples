# Drawing Dragon Curve with WebAssembly

This example computes coordinates for [Dragon Curve](https://en.wikipedia.org/wiki/Dragon_curve) in native code and then draws it on canvas in JS.

## Files of interest

 - `dragon-curve.c` — source file for native module. It uses memory provided by caller.
 - `dragon-curve.wasm` — compiled native module, ready to use.
 - `dragon-curve.js` — runtime autogenerated by Emscripten. Contains functions for memory handling (`malloc` and `free`)
 - `dragon-curve-wrapper.js` — example of JS wrapper function that hides implementation details and allocates memory
 - `index.html` — example of using WASM from browser

## Building

TODO: How to build just WASM file, without runtime.

### Building with Docker

To build WASM file and JS runtime

```sh
docker run --rm -v $(pwd):$(pwd) -u $(id -u):$(id -g) trzeci/emscripten emcc $(pwd)/dragon-curve.c -o $(pwd)/dragon-curve.js -s EXPORTED_FUNCTIONS='["_dragon_curve"]' -s EXPORTED_RUNTIME_METHODS='["ccall"]' -s ALLOW_MEMORY_GROWTH=1
```

## Running

 1. Run web server in this directory:

    ```sh
    # If you have ruby installed
    ruby -run -e httpd . -p 8000
    # Or if you have python3
    python -m http.server
    ```

 2. Open http://localhost:8000/ in your browser.
